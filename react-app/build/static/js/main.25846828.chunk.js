(this["webpackJsonpreact-app"]=this["webpackJsonpreact-app"]||[]).push([[0],{102:function(e,t,a){},103:function(e,t,a){},104:function(e,t,a){},105:function(e,t,a){},107:function(e,t,a){"use strict";a.r(t);var s=a(0),n=a.n(s),l=a(15),r=a.n(l),o=(a(57),a(27)),c=a.n(o),i=a(37),m=a(20),u=a(5),d=a(6),h=a(7),p=a(8),f=(a(59),a(17)),g=a(3),v=function(e){Object(p.a)(a,e);var t=Object(h.a)(a);function a(){var e;Object(u.a)(this,a);for(var s=arguments.length,n=new Array(s),l=0;l<s;l++)n[l]=arguments[l];return(e=t.call.apply(t,[this].concat(n))).state={email:"",password:"",isSubmitted:!1,errorMessage:"",firstName:"",lastName:"",confirmPassword:"",signupSuccessful:!1},e.handleInputChange=function(t){var a=t.target,s=a.name,n=a.value;e.setState(Object(m.a)({},s,n))},e.validateForm=function(){var t=!1;return e.state.password!==e.state.confirmPassword&&(e.setState({errorMessage:"Passwords must match. Please try again."}),t=!0),e.state.password.length<8&&(e.setState({errorMessage:"Password must be at least 8 characters in length."}),t=!0),e.state.firstName.length<3&&(e.setState({errorMessage:"First name must be between 3 and 50 characters."}),t=!0),(e.state.lastName.length>50||e.state.lastName.length<3)&&(e.setState({errorMessage:"Last name must be between 3 and 50 characters."}),t=!0),/^\w+([\.-]?\w+)*@\w+([\.-]?\w+)*(\.\w{2,3})+$/.test(e.state.email)||(e.setState({errorMessage:"Please enter a valid email address."}),t=!0),t},e.errorResponseIsDuplicateEmail=function(){var e=Object(i.a)(c.a.mark((function e(t){var a;return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t.json();case 2:return a=e.sent,e.abrupt("return",400===t.status&&"mongoerror"===a.name.toLowerCase()&&a.keyValue.email&&11e3===a.code);case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),e.handleLoginButtonClick=function(t){t.preventDefault();var a={email:e.state.email,password:e.state.password,firstName:e.state.firstName,lastName:e.state.lastName};e.validateForm()||(fetch("/auth/signup",{method:"post",headers:{Accept:"application/json","Content-Type":"application/json"},body:JSON.stringify(a)}).then((function(e){if(!e.ok)throw e;return e.json()})).then((function(t){console.log("GOT this user",t),e.setState({signupSuccessful:!0})})).catch(function(){var t=Object(i.a)(c.a.mark((function t(a){return c.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e.errorResponseIsDuplicateEmail(a);case 2:if(!t.sent){t.next=4;break}e.setState({errorMessage:"This user already exists. Please try again."});case 4:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}()),e.setState({errorMessage:"",email:"",firstName:"",lastName:"",password:"",confirmPassword:""}))},e}return Object(d.a)(a,[{key:"render",value:function(){return this.state.signupSuccessful?n.a.createElement(f.a,{to:"/postsignup"}):n.a.createElement("div",{className:"container"},n.a.createElement("div",{className:"row"},n.a.createElement("div",{className:"col-md-6 login-form-1 offset-md-3"},n.a.createElement("h2",null,"Sign Up"),n.a.createElement("form",null,n.a.createElement("div",{className:"form-group"},n.a.createElement("input",{onChange:this.handleInputChange,name:"firstName",type:"text",className:"form-control",placeholder:"First Name *",value:this.state.firstName})),n.a.createElement("div",{className:"form-group"},n.a.createElement("input",{onChange:this.handleInputChange,name:"lastName",type:"text",className:"form-control",placeholder:"Last Name *",value:this.state.lastName})),n.a.createElement("div",{className:"form-group"},n.a.createElement("input",{onChange:this.handleInputChange,name:"email",type:"text",className:"form-control",placeholder:"Your Email *",value:this.state.email})),n.a.createElement("div",{className:"form-group"},n.a.createElement("input",{onChange:this.handleInputChange,type:"password",className:"form-control",name:"password",placeholder:"Your Password *",value:this.state.password})),n.a.createElement("div",{className:"form-group"},n.a.createElement("input",{onChange:this.handleInputChange,type:"password",className:"form-control",name:"confirmPassword",placeholder:"Retype Password *",value:this.state.confirmPassword})),n.a.createElement("p",null,this.state.errorMessage),n.a.createElement("div",{className:"form-group"},n.a.createElement("input",{onClick:this.handleLoginButtonClick,type:"submit",className:"btnSubmit",value:"Sign Up"})),n.a.createElement("div",{className:"form-group"},n.a.createElement(g.b,{className:"login-button",to:"/login"},n.a.createElement("input",{type:"submit",className:"btnSubmit",value:"Login Here"})))))))}}]),a}(s.Component),b=a(13),E=(a(65),function(e){Object(p.a)(a,e);var t=Object(h.a)(a);function a(){var e;Object(u.a)(this,a);for(var s=arguments.length,n=new Array(s),l=0;l<s;l++)n[l]=arguments[l];return(e=t.call.apply(t,[this].concat(n))).state={email:"",password:"",isSubmitted:!1,errorMessage:"",redirect:null},e.handleInputChange=function(t){var a=t.target,s=a.name,n=a.value;e.setState(Object(m.a)({},s,n))},e.handleLoginButtonClick=function(t){t.preventDefault();var a={email:e.state.email,password:e.state.password},s=Object(b.a)(e);fetch("/auth/login",{method:"post",headers:{Accept:"application/json","Content-Type":"application/json"},body:JSON.stringify(a)}).then((function(e){if(!e.ok)throw e;return e.json()})).then((function(e){s.props.setGlobalUser(e),s.setState({redirect:"/home"})})).catch((function(t){401===t.status&&e.setState({errorMessage:"Login failed. Please try again."}),console.log("sorry, got an error",t)}))},e}return Object(d.a)(a,[{key:"render",value:function(){return this.state.redirect?n.a.createElement(f.a,{to:this.state.redirect}):n.a.createElement("div",{className:"container"},n.a.createElement("div",{className:"row"},n.a.createElement("div",{className:"col-md-6 login-form-1 offset-md-3"},n.a.createElement("h2",null,"Log In"),n.a.createElement("form",null,n.a.createElement("div",{className:"form-group"},n.a.createElement("input",{onChange:this.handleInputChange,name:"email",type:"text",className:"form-control",placeholder:"Your Email *",value:this.state.email})),n.a.createElement("div",{className:"form-group"},n.a.createElement("input",{onChange:this.handleInputChange,type:"password",className:"form-control",name:"password",placeholder:"Your Password *",value:this.state.password})),n.a.createElement("p",null,this.state.errorMessage),n.a.createElement("div",{className:"form-group"},n.a.createElement("input",{onClick:this.handleLoginButtonClick,type:"submit",className:"btnSubmit",value:"Login"})),n.a.createElement("div",{className:"form-group"},n.a.createElement(g.b,{className:"sign-up-button",to:"/signup"},n.a.createElement("input",{type:"submit",className:"btnSubmit",value:"Sign Up Here"})))))))}}]),a}(s.Component)),y=a(51),w=(a(66),a(16));a(67);var N=function(){return n.a.createElement("div",{className:"header"},n.a.createElement("h1",null,"Bowled Over"))};a(68);var S=function(){return n.a.createElement("div",{className:"loading"},"Loading\u2026")},k=(a(69),function(e){Object(p.a)(a,e);var t=Object(h.a)(a);function a(){var e;Object(u.a)(this,a);for(var s=arguments.length,n=new Array(s),l=0;l<s;l++)n[l]=arguments[l];return(e=t.call.apply(t,[this].concat(n))).state={topScore:0,lowestScore:0,averageScore:0,playerYouDoTheBestAgainst:"N/A",playerYouDoTheWorstAgainst:"N/A",mostCommonOpponent:"N/A",sessions:[],alleys:[],isLoading:!0},e}return Object(d.a)(a,[{key:"componentWillMount",value:function(){var e,t=this;fetch("/api/user/stats").then((function(e){if(!e.ok)throw e;return e.json()})).then((function(e){console.log("got stats",e),t.setState(Object(w.a)({},e))})).catch((function(e){return console.error(e)})),fetch("/api/user/alleys").then((function(e){if(!e.ok)throw e;return e.json()})).then((function(t){return e=t,fetch("/api/session")})).then((function(e){if(!e.ok)throw e;return e.json()})).then((function(a){console.log("got sessions",a),a.forEach((function(t){t.alley=e.find((function(e){return e._id===t.alleyId}))})),t.setState({sessions:a,isLoading:!1})})).catch((function(e){return console.error(e)}))}},{key:"render",value:function(){return this.state.isLoading?n.a.createElement(S,null):n.a.createElement("div",{className:"container"},n.a.createElement(N,null),n.a.createElement("div",{className:"row"},n.a.createElement("div",{className:"card col-md-10 offset-md-1"},n.a.createElement("h3",null,"Stats"),n.a.createElement("table",{className:"table"},n.a.createElement("tbody",null,n.a.createElement("tr",null,n.a.createElement("td",{className:"stat"},"High Score"),n.a.createElement("td",null,this.state.topScore)),n.a.createElement("tr",null,n.a.createElement("td",{className:"stat"},"Average Score"),n.a.createElement("td",null,this.state.averageScore)),n.a.createElement("tr",null,n.a.createElement("td",{className:"stat"},"Low Score"),n.a.createElement("td",null,this.state.lowestScore)),n.a.createElement("tr",null,n.a.createElement("td",{className:"stat"},"Most Common Opponent"),n.a.createElement("td",null,this.state.mostCommonOpponent)),n.a.createElement("tr",null,n.a.createElement("td",{className:"stat"},"Opponent You Play Best Against"),n.a.createElement("td",null,this.state.playerYouDoTheBestAgainst)),n.a.createElement("tr",null,n.a.createElement("td",{className:"stat"},"Opponent You Play Worst Against"),n.a.createElement("td",null,this.state.playerYouDoTheWorstAgainst)))),n.a.createElement("div",{className:"row"},n.a.createElement("div",{className:"col-sm-9"},n.a.createElement("div",null,n.a.createElement("h3",null,"Sessions"))),n.a.createElement("div",{className:"col-sm-3 float-right"},n.a.createElement(g.b,{className:"new-session",to:"/session/new"},n.a.createElement("button",{type:"button",className:"btn btn-outline-dark btn-sm"},"Start New Session")))),n.a.createElement("table",{className:"table"},n.a.createElement("tbody",null,this.state.sessions.map((function(e){if(!e.alley)return null;var t=e.games.length>0?new Date(e.games[0].timePlayed).toLocaleDateString():"Date not available";return n.a.createElement("tr",null,n.a.createElement("td",null,e.alley.name),n.a.createElement("td",null,t),n.a.createElement("td",null,e.games.length," Games played"),n.a.createElement("td",null,n.a.createElement(g.b,{className:"new-session",to:"/session/".concat(e._id)},n.a.createElement("button",{type:"button",class:"btn btn-light"},"Edit"))))})))),n.a.createElement("hr",null))))}}]),a}(s.Component)),j=(a(70),function(){return n.a.createElement("div",{className:"container"},n.a.createElement(N,null),n.a.createElement("div",{className:"col-md-4 offset-md-4 verified"},"Great! Thanks for verifying your email!",n.a.createElement("br",null),n.a.createElement("br",null),n.a.createElement(g.b,{className:"",to:"/login"},n.a.createElement("button",{type:"button",className:"btn btn-outline-dark btn-sm"},"Take Me To The Login Page"))))}),O=a(9),C=a(26);a(73);var A,T=function(e){return n.a.createElement("nav",{"aria-label":"breadcrumb",className:"breadcrumbNav"},n.a.createElement("ol",{className:"breadcrumb"},e.links.map((function(e){return n.a.createElement("li",{className:"breadcrumb-item"},n.a.createElement(g.b,{to:e.address},e.name))})),n.a.createElement("li",{className:"breadcrumb-item active","aria-current":"page"},e.currentPage)))},M=(a(74),function(e){Object(p.a)(a,e);var t=Object(h.a)(a);function a(){var e;Object(u.a)(this,a);for(var s=arguments.length,n=new Array(s),l=0;l<s;l++)n[l]=arguments[l];return(e=t.call.apply(t,[this].concat(n))).state={isNew:!1,session:{alley:{},games:[]},alleys:[],opponents:[],selectedAlley:{},isLoading:!0,successMessage:"",errorMessage:""},e}return Object(d.a)(a,[{key:"componentDidMount",value:function(){var e=this;console.log(this.props.match.params.sessionId),"new"===this.props.match.params.sessionId?(this.setState({isNew:!0}),fetch("/api/user/alleys").then((function(e){if(!e.ok)throw e;return e.json()})).then((function(t){console.log("got the alleys",t),e.setState({alleys:t,isLoading:!1})})).catch((function(e){return console.error(e)}))):this.getSession(this.props.match.params.sessionId)}},{key:"getSession",value:function(e){var t,a=this;fetch("/api/user/alleys").then((function(e){if(!e.ok)throw e;return e.json()})).then((function(e){return t=e,console.log("got the alleys",e),a.setState({alleys:e}),fetch("/api/user/common-opponents")})).then((function(e){if(!e.ok)throw e;return e.json()})).then((function(t){return a.setState({opponents:t}),fetch("/api/session/".concat(e))})).then((function(e){if(!e.ok)throw e;return e.json()})).then((function(e){e.alley=t.find((function(t){return t._id===e.alleyId})),console.log("got session",e),a.setState({session:e,selectedAlley:e.alley,isLoading:!1})})).catch((function(e){return console.error(e)}))}},{key:"handleAlleysChange",value:function(e,t){"create-option"===t.action?(this.createNewAlley(e.value),console.log("creating new alley",e)):e?this.setState({selectedAlley:this.state.alleys.find((function(t){return t._id===e.value}))}):this.setState({selectedAlley:{}})}},{key:"createNewAlley",value:function(e){var t=this,a={name:e};fetch("/api/user/alleys",{headers:{"Content-Type":"application/json"},method:"post",body:JSON.stringify(a)}).then((function(e){if(!e.ok)throw e;return e.json()})).then((function(e){console.log("created alley",e);var a=[].concat(Object(O.a)(t.state.alleys),[e]);t.setState({alleys:a,selectedAlley:e})})).catch((function(e){t.setState({errorMessage:"Sorry, something went wrong"}),console.error(e)}))}},{key:"saveSession",value:function(){var e=this;if(this.setState({successMessage:"",errorMessage:""}),this.state.isNew&&this.state.selectedAlley){var t={alleyId:this.state.selectedAlley._id};console.log("posting new session",t),fetch("/api/session",{headers:{"Content-Type":"application/json"},method:"post",body:JSON.stringify(t)}).then((function(e){if(!e.ok)throw e;return e.json()})).then((function(t){console.log("created session",t),e.setState({isNew:!1,successMessage:"Session created successfully",session:t})})).catch((function(t){e.setState({errorMessage:"Sorry, something went wrong"}),console.error(t)}))}else if(this.state.session&&this.state.selectedAlley){var a=this.state.selectedAlley._id,s=Object(w.a)({},this.state.session,{alleyId:a,alley:void 0});console.log("updating session",s),fetch("/api/session/".concat(this.state.session._id),{headers:{"Content-Type":"application/json"},method:"put",body:JSON.stringify(s)}).then((function(e){if(!e.ok)throw e;return e.json()})).then((function(t){e.getSession(t._id),e.setState({successMessage:"Session saved"})})).catch((function(e){return console.error(e)}))}}},{key:"render",value:function(){var e=this;return this.state.isLoading?n.a.createElement(S,null):n.a.createElement("div",{className:"container"},n.a.createElement("div",{className:"row"},n.a.createElement("div",{className:"session-card col-md-10 offset-md-1"},n.a.createElement(T,{links:[{name:"Home",address:"/"}],currentPage:"Session"}),n.a.createElement("div",{className:"row"},n.a.createElement("div",{className:"col-sm-8 offset-md-1"},n.a.createElement("div",null,n.a.createElement("h4",null,"Pick an Alley"),n.a.createElement("p",null,"Select an alley from the drop down below, or type to add a new one"))),n.a.createElement("div",{className:"col-sm-2 float-sm-right"},n.a.createElement("button",{type:"button",onClick:this.saveSession.bind(this),className:"btn btn-outline-dark btn-lg float-right"},"Save"))),n.a.createElement("div",{className:"row"},n.a.createElement("div",{className:"col-sm-10 offset-md-1"},this.state.successMessage?n.a.createElement("div",{className:"alert alert-success",role:"alert"},this.state.successMessage):null,this.state.errorMessage?n.a.createElement("div",{className:"alert alert-success",role:"alert"},this.state.errorMessage):null)),n.a.createElement("div",{className:"row"},n.a.createElement("div",{className:"col-md-10 offset-md-1"},n.a.createElement(C.a,{isClearable:!0,name:"colors",options:this.state.alleys.map((function(e){return{label:e.name,value:e._id}})),classNamePrefix:"select",id:"alleys",onChange:this.handleAlleysChange.bind(this),value:{label:this.state.selectedAlley.name,value:this.state.selectedAlley._id}}))),this.state.isNew?null:n.a.createElement("div",null,n.a.createElement("div",{className:"row"},n.a.createElement("div",{className:"col-md-10 offset-md-1"},n.a.createElement("h4",null,"Games"),n.a.createElement("table",{className:"table"},n.a.createElement("tbody",null,this.state.session.games.map((function(t){var a=new Date(t.timePlayed).toLocaleTimeString();return n.a.createElement("tr",{key:"game-".concat(t._id)},n.a.createElement("td",null,a),n.a.createElement("td",null,"vs. ",t.players.map((function(t){return e.state.opponents.find((function(e){return e._id===t})).name})).join(", ")),n.a.createElement("td",null,"Score: ",t.totalScore),n.a.createElement("td",null,n.a.createElement(g.b,{className:"new-session",to:"/session/".concat(e.state.session._id,"/game/").concat(t._id)},n.a.createElement("button",{type:"button",className:"btn btn-light"},"Edit"))))})))))),n.a.createElement("div",{className:"row"},n.a.createElement("div",{className:"col-md-10 offset-md-1"},n.a.createElement(g.b,{className:"new-session",to:"/session/".concat(this.state.session._id,"/game/new")},n.a.createElement("button",{type:"button",className:"btn btn-outline-dark"},"Start New Game"))))))))}}]),a}(s.Component)),P=a(25),_=(a(75),Object(O.a)(Array(10).keys()).map((function(e){return e+1}))),B=Object(O.a)(Array(21).keys()),I=function(e){Object(p.a)(a,e);var t=Object(h.a)(a);function a(){var e;Object(u.a)(this,a);for(var s=arguments.length,n=new Array(s),l=0;l<s;l++)n[l]=arguments[l];return(e=t.call.apply(t,[this].concat(n))).state={selected:0,currentThrow:1,frameThrows:Object(O.a)(Array(21).keys()).map((function(){return{disabled:!0,displayValue:"",value:""}})),buttons:Object(O.a)(Array(11).keys()).map((function(e){return{disabled:!1,value:e,displayValue:10===e?"X":e}}))},e.handleScoreButtonClicked=function(t){console.log("you got ",t);var a=e.state.selected,s=Object(O.a)(e.state.frameThrows);s[e.state.selected]={disabled:!1,displayValue:t.displayValue,value:t.value},s[e.state.selected+1]&&(s[e.state.selected+1].disabled=!1),a++,"X"===t.displayValue&&e.state.selected<18&&(s[e.state.selected+1]={disabled:!0,value:"",displayValue:""},a++),e.state.selected%2===0&&e.state.frameThrows[e.state.selected+1]&&(e.state.frameThrows[e.state.selected+1].value="",e.state.frameThrows[e.state.selected+1].displayValue="",e.state.frameThrows[e.state.selected+2]&&""===e.state.frameThrows[e.state.selected+2].value&&(s[e.state.selected+2].disabled=!0));var n=e.getButtonsForThrow(t.value,a);e.setState({frameThrows:s,selected:a,buttons:n}),e.props.setFrames(s)},e}return Object(d.a)(a,[{key:"componentDidMount",value:function(){this.setInitialFrameThrows(this.props.frames)}},{key:"setInitialFrameThrows",value:function(e){for(var t=Object(O.a)(this.state.frameThrows),a=0,s=0;s<t.length;s++)if(s<18){var n=!1;s%2===0&&(a++,n=!0);var l=e.find((function(e){return e.number===a}));l&&(n?(t[s].value="X"===l.scores[0]?10:l.scores[0],t[s].displayValue=l.scores[0],t[s].disabled=void 0===l.scores[0]):(t[s].value="/"===l.scores[0]?10-t[s-1].value:l.scores[1],t[s].displayValue=l.scores[1],t[s].disabled=void 0===l.scores[1]))}var r=e.find((function(e){return 10===e.number}));if(r){var o,c=18,i=Object(P.a)(r.scores);try{for(i.s();!(o=i.n()).done;){var m=o.value;t[c].value="/"===m?10-t[c-1].value:m,t[c].displayValue=m,t[c].disabled=void 0===m,c++}}catch(u){i.e(u)}finally{i.f()}}this.setState({frameThrows:t})}},{key:"selectScore",value:function(e){if(console.log("clicked",e),!this.state.frameThrows[e].disabled){var t=this.state.frameThrows[e-1]?this.state.frameThrows[e-1].value:null,a=this.getButtonsForThrow(t,e);this.setState({selected:e,buttons:a})}}},{key:"getButtonsForThrow",value:function(e,t){console.log("button value",e,"selected",t);var a=Object(O.a)(Array(11).keys()).map((function(e){return{disabled:!1,value:e,displayValue:10===e?"X":e}}));return this.state.selected,t%2===0?(console.log("it should reset"),a):(0===e?a[10].displayValue="/":a.forEach((function(t,a){a===10-e&&(t.displayValue="/"),a>10-e&&(t.disabled=!0)})),a)}},{key:"render",value:function(){var e=this;return n.a.createElement("div",{className:"container"},n.a.createElement("div",{className:"row"},n.a.createElement("div",{className:"table-responsive"},n.a.createElement("table",{className:"table table-bordered table-hover"},n.a.createElement("tr",null,_.map((function(e){var t=10===e?"3":"2";return n.a.createElement("th",{colspan:t},"Frame ",e)}))),n.a.createElement("tr",{className:"throwsRow"},B.map((function(t,a){var s=e.state.selected===a?"throw selected":"throw";return e.state.frameThrows[a].disabled&&(s+=" disabled"),n.a.createElement("td",{onClick:function(){return e.selectScore(a)},className:s},e.state.frameThrows[a].displayValue)})))))),n.a.createElement("div",{className:"row"},n.a.createElement("div",{className:"col btn-col"},this.state.buttons.filter((function(e){return!e.disabled})).map((function(t){return n.a.createElement("button",{type:"button",className:"score-btn btn btn-lg btn-outline-secondary",value:t.displayValue,onClick:function(){return e.handleScoreButtonClicked(t)}},t.displayValue)})))))}}]),a}(s.Component),L=a(50),x=a.n(L),D=(a(102),function(e){Object(p.a)(a,e);var t=Object(h.a)(a);function a(e){var s;return Object(u.a)(this,a),(s=t.call(this,e)).state={game:{frames:[],ballsUsed:[],players:[]},opponents:[],balls:[],isLoading:!0,successMessage:"",errorMessage:"",selectedBalls:[],selectedPlayers:[],timePlayed:new Date,totalScore:0},A=Object(b.a)(s),s}return Object(d.a)(a,[{key:"componentDidMount",value:function(){console.log(this.props.match.params.sessionId),"new"===this.props.match.params.gameId?(this.setState({isNew:!0}),this.getBallsAndOpponents()):this.getGame(this.props.match.params.gameId)}},{key:"getBallsAndOpponents",value:function(){var e=this;fetch("/api/user/balls").then((function(e){if(!e.ok)throw e;return e.json()})).then((function(t){return console.log("got the balls",t),e.setState({balls:t}),fetch("/api/user/common-opponents")})).then((function(e){if(!e.ok)throw e;return e.json()})).then((function(t){console.log("got the opponents",t),e.setState({opponents:t,isLoading:!1})})).catch((function(e){return console.error(e)}))}},{key:"getTotalScoreForFrames",value:function(e){var t=this;fetch("/api/calc/totalscore",{headers:{"Content-Type":"application/json"},method:"post",body:JSON.stringify({frames:e})}).then((function(e){if(!e.ok)throw e;return e.json()})).then((function(e){t.setState({totalScore:e.totalScore})})).catch((function(e){return console.error(e)}))}},{key:"getGame",value:function(e){var t,a,s=this;fetch("/api/user/balls").then((function(e){if(!e.ok)throw e;return e.json()})).then((function(e){return console.log("got the balls",e),s.setState({balls:e}),t=e,fetch("/api/user/common-opponents")})).then((function(e){if(!e.ok)throw e;return e.json()})).then((function(t){return console.log("got the opponents",t),s.setState({opponents:t}),a=t,fetch("/api/session/".concat(s.props.match.params.sessionId,"/game/").concat(e))})).then((function(e){if(!e.ok)throw e;return e.json()})).then((function(e){console.log("got game",e);var n={game:e,selectedPlayers:e.players.map((function(e){return a.find((function(t){return e===t._id}))})),selectedBalls:e.ballsUsed.map((function(e){return t.find((function(t){return e===t._id}))})),timePlayed:new Date(e.timePlayed),isLoading:!1,totalScore:e.totalScore};console.log("setting new state",n),s.setState(n)})).catch((function(e){return console.error(e)}))}},{key:"setFrames",value:function(e){console.log("got the frames back!",e);for(var t=[],a={},s=1,n=0;n<e.length;n++)n<18&&(n%2===0?a={number:s,scores:[e[n].displayValue]}:(a.scores.push(e[n].displayValue),a.scores=a.scores.filter((function(e){return""!==e&&null!==e&&void 0!==e})),t.push(a),s++));t.push({number:10,scores:[e[18].displayValue,e[19].displayValue,e[20].displayValue].filter((function(e){return""!==e}))}),t=t.filter((function(e){return e.scores.length>0})),console.log("new frames",t);var l=Object(w.a)({},A.state.game,{frames:t});A.getTotalScoreForFrames(t),A.setState({game:l})}},{key:"handleBallsUsedChange",value:function(e,t){var a=this;if("create-option"===t.action){var s=e.find((function(e){return!0===e.__isNew__}));this.createNewBall(s.value),console.log("creating new ball",e)}else if(e){console.log("this.state.balls",this.state.balls);var n,l=[],r=Object(P.a)(e);try{var o=function(){var e=n.value;l.push(a.state.balls.find((function(t){return t._id===e.value})))};for(r.s();!(n=r.n()).done;)o()}catch(c){r.e(c)}finally{r.f()}console.log("new selected balls",l),this.setState({selectedBalls:l})}else this.setState({selectedBalls:[]})}},{key:"handleOpponentsChange",value:function(e,t){var a=this;if("create-option"===t.action){var s=e.find((function(e){return!0===e.__isNew__}));this.createNewOpponent(s.value),console.log("creating new alley",e)}else if(e){var n,l=[],r=Object(P.a)(e);try{var o=function(){var e=n.value;l.push(a.state.opponents.find((function(t){return t._id===e.value})))};for(r.s();!(n=r.n()).done;)o()}catch(c){r.e(c)}finally{r.f()}console.log("new selected players",l),this.setState({selectedPlayers:l})}else this.setState({selectedPlayers:[]})}},{key:"createNewOpponent",value:function(e){var t=this,a={name:e};fetch("/api/user/common-opponents",{headers:{"Content-Type":"application/json"},method:"post",body:JSON.stringify(a)}).then((function(e){if(!e.ok)throw e;return e.json()})).then((function(e){console.log("created opp",e);var a=[].concat(Object(O.a)(t.state.opponents),[e]),s=[].concat(Object(O.a)(t.state.selectedPlayers),[e]);t.setState({opponents:a,selectedPlayers:s})})).catch((function(e){t.setState({errorMessage:"Sorry, something went wrong"}),console.error(e)}))}},{key:"createNewBall",value:function(e){var t=this,a={name:e};fetch("/api/user/balls",{headers:{"Content-Type":"application/json"},method:"post",body:JSON.stringify(a)}).then((function(e){if(!e.ok)throw e;return e.json()})).then((function(e){console.log("created ball",e,t.state.selectedBalls);var a=[].concat(Object(O.a)(t.state.balls),[e]),s=[].concat(Object(O.a)(t.state.selectedBalls),[e]);console.log("new selected balls",s),t.setState({balls:a,selectedBalls:s})})).catch((function(e){t.setState({errorMessage:"Sorry, something went wrong"}),console.error(e)}))}},{key:"handleTimePlayedChange",value:function(e){console.log("new time changed",e),this.setState({timePlayed:e})}},{key:"saveGame",value:function(){var e=this;if(this.setState({successMessage:"",errorMessage:""}),this.state.isNew){var t=this.state.selectedBalls.map((function(e){return e._id})),a=this.state.selectedPlayers.map((function(e){return e._id})),s=Object(w.a)({},this.state.game,{timePlayed:this.state.timePlayed,ballsUsed:t,players:a});console.log("posting new game",s),fetch("/api/session/".concat(this.props.match.params.sessionId,"/game"),{headers:{"Content-Type":"application/json"},method:"post",body:JSON.stringify(s)}).then((function(e){if(!e.ok)throw e;return e.json()})).then((function(t){console.log("created game",t),e.setState({isNew:!1,successMessage:"Game created successfully",game:t})})).catch((function(t){e.setState({errorMessage:"Sorry, something went wrong"}),console.error(t)}))}else if(this.state.game){var n=this.state.selectedBalls.map((function(e){return e._id})),l=this.state.selectedPlayers.map((function(e){return e._id})),r=Object(w.a)({},this.state.game,{timePlayed:this.state.timePlayed,ballsUsed:n,players:l});console.log("updating game",r),fetch("/api/session/".concat(this.props.match.params.sessionId,"/game/").concat(this.state.game._id),{headers:{"Content-Type":"application/json"},method:"put",body:JSON.stringify(r)}).then((function(e){if(!e.ok)throw e;return e.json()})).then((function(t){e.getGame(t._id),e.setState({successMessage:"Game saved"})})).catch((function(e){return console.error(e)}))}}},{key:"render",value:function(){return this.state.isLoading?n.a.createElement(S,null):n.a.createElement("div",{className:"container"},n.a.createElement("div",{className:"row"},n.a.createElement("div",{className:"game-card col-md-12"},n.a.createElement(T,{links:[{name:"Home",address:"/"},{name:"Session",address:"/session/".concat(this.props.match.params.sessionId)}],currentPage:"Game"}),n.a.createElement("hr",null),n.a.createElement("div",{className:"row"},n.a.createElement("div",{className:"col-sm-10"},n.a.createElement("div",null,n.a.createElement("h4",null,"Game"),n.a.createElement("p",null,"Setup the game how it was played"))),n.a.createElement("div",{className:"col-sm-2 float-sm-right"},n.a.createElement("button",{type:"button",onClick:this.saveGame.bind(this),className:"btn btn-outline-dark btn-lg float-right"},"Save"))),n.a.createElement("div",{className:"row"},n.a.createElement("div",{className:"col-sm-12"},this.state.successMessage?n.a.createElement("div",{className:"alert alert-success",role:"alert"},this.state.successMessage):null,this.state.errorMessage?n.a.createElement("div",{className:"alert alert-success",role:"alert"},this.state.errorMessage):null)),n.a.createElement("hr",null),n.a.createElement("div",{className:"row"},n.a.createElement("div",{style:{height:"100%",verticalAlign:"center"},className:"col-md-2"},n.a.createElement("label",null,"Time Played")),n.a.createElement("div",{className:"col-md-10"},n.a.createElement(x.a,{className:"datetime",onChange:this.handleTimePlayedChange.bind(this),value:this.state.timePlayed}))),n.a.createElement("hr",null),n.a.createElement("div",{className:"row"},n.a.createElement("div",{className:"col-md-2"},n.a.createElement("label",{for:"opponents"},"Opponents")),n.a.createElement("div",{className:"col-md-10"},n.a.createElement(C.a,{isMulti:!0,name:"colors",options:this.state.opponents.map((function(e){return{label:e.name,value:e._id}})),className:"basic-multi-select",classNamePrefix:"select",id:"opponents",onChange:this.handleOpponentsChange.bind(this),value:this.state.selectedPlayers.map((function(e){return{label:e.name,value:e._id}}))}))),n.a.createElement("hr",null),n.a.createElement("div",{className:"row"},n.a.createElement("div",{className:"col-md-2"},n.a.createElement("label",{for:"balls"},"Balls")),n.a.createElement("div",{className:"col-md-10"},n.a.createElement(C.a,{isMulti:!0,name:"colors",options:this.state.balls.map((function(e){return{label:e.name,value:e._id}})),className:"basic-multi-select",classNamePrefix:"select",id:"balls",onChange:this.handleBallsUsedChange.bind(this),value:this.state.selectedBalls.map((function(e){return{label:e.name,value:e._id}}))}))),n.a.createElement("hr",null),n.a.createElement("div",{className:"row"},n.a.createElement("div",{className:"col text-center"},n.a.createElement("h3",null,"Total Score: ",this.state.totalScore))),n.a.createElement(I,{setFrames:this.setFrames,frames:this.state.game.frames}))))}}]),a}(s.Component)),V=(a(103),function(e){Object(p.a)(a,e);var t=Object(h.a)(a);function a(){var e;Object(u.a)(this,a);for(var s=arguments.length,n=new Array(s),l=0;l<s;l++)n[l]=arguments[l];return(e=t.call.apply(t,[this].concat(n))).state={redirect:null},e.logout=function(t){var a=Object(b.a)(e);t.preventDefault(),fetch("/auth/logout").then((function(e){if(!e.ok)throw e;a.setState({redirect:"/login"})})).catch((function(e){console.error(e)}))},e}return Object(d.a)(a,[{key:"render",value:function(){return this.state.redirect?n.a.createElement(f.a,{to:this.state.redirect}):n.a.createElement("nav",{className:"navbar justify-content-between navbar-expand-md"},n.a.createElement(g.b,{className:"navbar-brand",to:"/home"},"Bowled Over"),n.a.createElement("button",{className:"navbar-toggler",type:"button","data-toggle":"collapse","data-target":"#navbarNavDropdown","aria-controls":"navbarNavDropdown","aria-expanded":"false","aria-label":"Toggle navigation"},n.a.createElement("span",{className:"navbar-toggler-icon"})),n.a.createElement("div",{className:"navbar-collapse collapse w-100 order-3 dual-collapse2",id:"navbarNavDropdown"},n.a.createElement("ul",{className:"navbar-nav ml-auto"},n.a.createElement("li",{className:"nav-item dropdown"},n.a.createElement("a",{className:"nav-link dropdown-toggle",href:"#",id:"navbarDropdownMenuLink","data-toggle":"dropdown","aria-haspopup":"true","aria-expanded":"false"},"".concat(this.props.firstName," ").concat(this.props.lastName)),n.a.createElement("div",{className:"dropdown-menu","aria-labelledby":"navbarDropdownMenuLink"},n.a.createElement("a",{className:"dropdown-item",href:"/profile"},"Profile"),n.a.createElement("a",{className:"dropdown-item",href:"#",onClick:this.logout},"Logout"))))))}}]),a}(s.Component)),F=(a(104),function(e){Object(p.a)(a,e);var t=Object(h.a)(a);function a(){var e;Object(u.a)(this,a);for(var s=arguments.length,n=new Array(s),l=0;l<s;l++)n[l]=arguments[l];return(e=t.call.apply(t,[this].concat(n))).state={firstName:"",lastName:"",email:"",opponents:[],balls:[]},e}return Object(d.a)(a,[{key:"componentDidMount",value:function(){this.getUserInfo()}},{key:"getUserInfo",value:function(){var e=this;fetch("/api/user").then((function(e){if(!e.ok)throw e;return e.json()})).then((function(t){console.log("this user is ",t),e.setState({firstName:t.firstName,lastName:t.lastName,email:t.email,opponents:t.commonOpponents,balls:t.balls})}))}},{key:"render",value:function(){return n.a.createElement("div",{className:"container"},n.a.createElement(N,null),n.a.createElement("div",{className:"row"},n.a.createElement("div",{className:"prof-card col-md-8 offset-md-2"},n.a.createElement("form",null,n.a.createElement("div",{class:"form-group row"},n.a.createElement("label",{for:"staticEmail",class:"col-sm-2 col-form-label"},"First Name"),n.a.createElement("div",{class:"col-sm-10"},n.a.createElement("input",{type:"text",readonly:!0,class:"form-control-plaintext",id:"staticFirstName",value:this.state.firstName}))),n.a.createElement("div",{class:"form-group row"},n.a.createElement("label",{for:"staticEmail",class:"col-sm-2 col-form-label"},"Last Name"),n.a.createElement("div",{class:"col-sm-10"},n.a.createElement("input",{type:"text",readonly:!0,class:"form-control-plaintext",id:"staticLastName",value:this.state.lastName}))),n.a.createElement("div",{class:"form-group row"},n.a.createElement("label",{for:"staticEmail",class:"col-sm-2 col-form-label"},"Email"),n.a.createElement("div",{class:"col-sm-10"},n.a.createElement("input",{type:"text",readonly:!0,class:"form-control-plaintext",id:"staticEmail",value:this.state.email}))),n.a.createElement("div",{class:"form-group row"},n.a.createElement("label",{for:"staticEmail",class:"col-sm-2 col-form-label"},"Opponents"),n.a.createElement("div",{class:"col-sm-10"},this.state.opponents.map((function(e){return n.a.createElement("input",{type:"text",readonly:!0,class:"form-control-plaintext",id:"staticEmail",value:e.name})})))),n.a.createElement("div",{class:"form-group row"},n.a.createElement("label",{for:"staticEmail",class:"col-sm-2 col-form-label"},"Balls"),n.a.createElement("div",{class:"col-sm-10"},this.state.balls.map((function(e){return n.a.createElement("input",{type:"text",readonly:!0,class:"form-control-plaintext",id:"staticEmail",value:e.name})}))))))))}}]),a}(s.Component)),G=(a(105),function(){return n.a.createElement("div",{className:"container"},n.a.createElement(N,null),n.a.createElement("div",{className:"row"},n.a.createElement("div",{className:"signup col-md-8 offset-md-2"},n.a.createElement("p",null,"Thanks for signing up for Bowled Over!"),n.a.createElement("p",null,"Please check your email for a verification link."))))}),U=null,J=function(e){Object(p.a)(a,e);var t=Object(h.a)(a);function a(e){var s;return Object(u.a)(this,a),(s=t.call(this,e)).state={isAuthenticated:!1,user:null,isCheckingAuth:!0},U=Object(b.a)(s),fetch("/api/user").then((function(e){if(401===e.status)throw U.setState({isAuthenticated:!1,isCheckingAuth:!1}),e;return console.log("got the res",e),e.json()})).then((function(e){console.log("got the logged in user",e),U.setState({isAuthenticated:!0,isCheckingAuth:!1,user:e})})).catch((function(e){console.error(e)})),s}return Object(d.a)(a,[{key:"setGlobalUser",value:function(e){console.log("setting user",e),U.setState({user:e,isAuthenticated:!0})}},{key:"render",value:function(){return this.state.isCheckingAuth?n.a.createElement(S,null):n.a.createElement(g.a,null,n.a.createElement("div",null,n.a.createElement(f.d,null,n.a.createElement(f.b,{path:"/login"},n.a.createElement(E,{setGlobalUser:this.setGlobalUser})),n.a.createElement(f.b,{path:"/signup"},n.a.createElement(v,null)),n.a.createElement(f.b,{path:"/verified"},n.a.createElement(j,null)),n.a.createElement(f.b,{path:"/postsignup"},n.a.createElement(G,null)),n.a.createElement(Y,{path:"/profile",user:this.state.user,component:F,isAuthenticated:this.state.isAuthenticated}),n.a.createElement(Y,{path:"/session/:sessionId/game/:gameId",user:this.state.user,component:D,isAuthenticated:this.state.isAuthenticated}),n.a.createElement(Y,{path:"/session/:sessionId",user:this.state.user,component:M,isAuthenticated:this.state.isAuthenticated}),n.a.createElement(Y,{path:"/",user:this.state.user,component:k,isAuthenticated:this.state.isAuthenticated}))))}}]),a}(s.Component),Y=function(e){var t=e.component,a=e.isAuthenticated,s=e.user,l=Object(y.a)(e,["component","isAuthenticated","user"]);return n.a.createElement(f.b,Object.assign({},l,{render:function(e){return!0===a?n.a.createElement("div",null,n.a.createElement(V,{firstName:s.firstName,lastName:s.lastName}),n.a.createElement(t,e)):n.a.createElement(f.a,{to:"/login"})}}))},W=J;Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));r.a.render(n.a.createElement(n.a.StrictMode,null,n.a.createElement(W,null)),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()})).catch((function(e){console.error(e.message)}))},52:function(e,t,a){e.exports=a(107)},57:function(e,t,a){},59:function(e,t,a){},65:function(e,t,a){},66:function(e,t,a){},67:function(e,t,a){},68:function(e,t,a){},69:function(e,t,a){},70:function(e,t,a){},73:function(e,t,a){},74:function(e,t,a){},75:function(e,t,a){}},[[52,1,2]]]);
//# sourceMappingURL=main.25846828.chunk.js.map